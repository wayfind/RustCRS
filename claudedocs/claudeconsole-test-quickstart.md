# Claude Console æµ‹è¯•å¿«é€Ÿå…¥é—¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: ä½¿ç”¨ä¸»æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /mnt/d/prj/claude-relay-service

# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ˆäº¤äº’å¼ï¼‰
bash run-full-test.sh

# ç³»ç»Ÿä¼šæç¤ºè¾“å…¥ï¼š
# 1. API Key
# 2. API Key ID
# 3. è´¦æˆ· ID
# 4. æµ‹è¯•æ—¶é•¿ï¼ˆç§’ï¼‰
```

### æ–¹å¼ 2: ç›´æ¥è¿è¡ŒæŒç»­è´Ÿè½½æµ‹è¯•

```bash
# ä½¿ç”¨ä¸åŒçš„æµ‹è¯•æ—¶é•¿
bash test-sustained-load.sh 60     # 1 åˆ†é’Ÿ
bash test-sustained-load.sh 180    # 3 åˆ†é’Ÿ
bash test-sustained-load.sh 300    # 5 åˆ†é’Ÿï¼ˆé»˜è®¤ï¼‰
bash test-sustained-load.sh 600    # 10 åˆ†é’Ÿ
bash test-sustained-load.sh 1800   # 30 åˆ†é’Ÿ
```

### æ–¹å¼ 3: è‡ªå®šä¹‰æµ‹è¯•æ—¶é•¿çš„å®Œæ•´æµ‹è¯•

```bash
# åˆ›å»ºè‡ªå®šä¹‰æµ‹è¯•è„šæœ¬
cat > my-custom-test.sh << 'EOF'
#!/bin/bash

# é…ç½®
API_KEY="cr_your_api_key_here"
API_KEY_ID="your_api_key_id"
ACCOUNT_ID="your_account_id"
TEST_DURATION=600  # 10 åˆ†é’Ÿ

# æ›´æ–°æµ‹è¯•è„šæœ¬é…ç½®
for script in test-*.sh monitor-stats.sh verify-stats.sh; do
  sed -i "s/YOUR_API_KEY_HERE/$API_KEY/g" "$script" 2>/dev/null
  sed -i "s/YOUR_API_KEY_ID/$API_KEY_ID/g" "$script" 2>/dev/null
  sed -i "s/YOUR_ACCOUNT_ID/$ACCOUNT_ID/g" "$script" 2>/dev/null
done

# è¿è¡Œæµ‹è¯•
echo "ğŸ§ª å¼€å§‹ ${TEST_DURATION} ç§’çš„æµ‹è¯•..."
bash test-sustained-load.sh $TEST_DURATION

# éªŒè¯ç»“æœ
echo "âœ… éªŒè¯ç»Ÿè®¡æ•°æ®..."
bash verify-stats.sh
EOF

chmod +x my-custom-test.sh
bash my-custom-test.sh
```

## ğŸ“Š å¸¸ç”¨æµ‹è¯•æ—¶é•¿å»ºè®®

| æµ‹è¯•ç›®çš„ | æ¨èæ—¶é•¿ | å‘½ä»¤ |
|---------|---------|------|
| å¿«é€ŸéªŒè¯ | 60 ç§’ (1åˆ†é’Ÿ) | `bash test-sustained-load.sh 60` |
| åŸºç¡€æµ‹è¯• | 180 ç§’ (3åˆ†é’Ÿ) | `bash test-sustained-load.sh 180` |
| æ ‡å‡†æµ‹è¯• | 300 ç§’ (5åˆ†é’Ÿ) | `bash test-sustained-load.sh 300` |
| æ·±åº¦æµ‹è¯• | 600 ç§’ (10åˆ†é’Ÿ) | `bash test-sustained-load.sh 600` |
| å‹åŠ›æµ‹è¯• | 1800 ç§’ (30åˆ†é’Ÿ) | `bash test-sustained-load.sh 1800` |
| é•¿æœŸç¨³å®šæ€§ | 3600 ç§’ (1å°æ—¶) | `bash test-sustained-load.sh 3600` |

## ğŸ¯ æµ‹è¯•æ—¶é•¿é€‰æ‹©æŒ‡å—

### å¿«é€ŸéªŒè¯ (60-120 ç§’)
**é€‚ç”¨åœºæ™¯**:
- åˆšæ·»åŠ æ–°è´¦æˆ·ï¼Œå¿«é€ŸéªŒè¯å¯ç”¨æ€§
- ä¿®å¤ bug åçš„å›å½’æµ‹è¯•
- CI/CD æµç¨‹ä¸­çš„è‡ªåŠ¨åŒ–æµ‹è¯•

**é¢„æœŸè¯·æ±‚æ•°**: ~20-40 ä¸ªè¯·æ±‚ï¼ˆæ¯3ç§’ä¸€ä¸ªï¼‰

### åŸºç¡€æµ‹è¯• (180-300 ç§’)
**é€‚ç”¨åœºæ™¯**:
- å¸¸è§„åŠŸèƒ½éªŒè¯
- æ¯æ—¥å¥åº·æ£€æŸ¥
- ç»Ÿè®¡æ•°æ®å‡†ç¡®æ€§éªŒè¯

**é¢„æœŸè¯·æ±‚æ•°**: ~60-100 ä¸ªè¯·æ±‚

### æ·±åº¦æµ‹è¯• (600-1800 ç§’)
**é€‚ç”¨åœºæ™¯**:
- ä¸Šçº¿å‰å®Œæ•´éªŒè¯
- æ€§èƒ½åŸºå‡†æµ‹è¯•
- è´Ÿè½½èƒ½åŠ›è¯„ä¼°

**é¢„æœŸè¯·æ±‚æ•°**: ~200-600 ä¸ªè¯·æ±‚

### é•¿æœŸç¨³å®šæ€§æµ‹è¯• (3600+ ç§’)
**é€‚ç”¨åœºæ™¯**:
- ç”Ÿäº§ç¯å¢ƒå‹åŠ›æµ‹è¯•
- å†…å­˜æ³„æ¼æ£€æµ‹
- é•¿æ—¶é—´ç¨³å®šæ€§éªŒè¯

**é¢„æœŸè¯·æ±‚æ•°**: 1200+ ä¸ªè¯·æ±‚

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. å¹¶è¡Œè¿è¡Œå¤šä¸ªæµ‹è¯•

```bash
# åŒæ—¶æµ‹è¯•å¤šä¸ªè´¦æˆ·
bash test-sustained-load.sh 300 &  # è´¦æˆ· 1
bash test-sustained-load.sh 300 &  # è´¦æˆ· 2ï¼ˆéœ€è¦ä¿®æ”¹è„šæœ¬é…ç½®ï¼‰
bash test-sustained-load.sh 300 &  # è´¦æˆ· 3ï¼ˆéœ€è¦ä¿®æ”¹è„šæœ¬é…ç½®ï¼‰
wait
echo "æ‰€æœ‰æµ‹è¯•å®Œæˆ"
```

### 2. å®æ—¶ç›‘æ§ + æµ‹è¯•

```bash
# ç»ˆç«¯ 1: å¯åŠ¨ç›‘æ§
bash monitor-stats.sh

# ç»ˆç«¯ 2: è¿è¡Œæµ‹è¯•
bash test-sustained-load.sh 600
```

### 3. ä¸åŒæ—¶é•¿çš„æ‰¹é‡æµ‹è¯•

```bash
# åˆ›å»ºæ‰¹é‡æµ‹è¯•è„šæœ¬
cat > batch-test.sh << 'EOF'
#!/bin/bash

echo "ğŸ“Š æ‰¹é‡æµ‹è¯•è®¡åˆ’"
echo "================================"

# æµ‹è¯• 1: å¿«é€ŸéªŒè¯
echo -e "\nğŸ”¹ æµ‹è¯• 1: å¿«é€ŸéªŒè¯ (60ç§’)"
bash test-sustained-load.sh 60 | tee logs/batch-test-60s.log
sleep 10

# æµ‹è¯• 2: æ ‡å‡†æµ‹è¯•
echo -e "\nğŸ”¹ æµ‹è¯• 2: æ ‡å‡†æµ‹è¯• (300ç§’)"
bash test-sustained-load.sh 300 | tee logs/batch-test-300s.log
sleep 10

# æµ‹è¯• 3: æ·±åº¦æµ‹è¯•
echo -e "\nğŸ”¹ æµ‹è¯• 3: æ·±åº¦æµ‹è¯• (600ç§’)"
bash test-sustained-load.sh 600 | tee logs/batch-test-600s.log

# æ±‡æ€»ç»“æœ
echo -e "\nğŸ“‹ æ‰¹é‡æµ‹è¯•æ±‡æ€»"
echo "================================"
for log in logs/batch-test-*.log; do
  echo -e "\næ–‡ä»¶: $log"
  grep "æ€»è¯·æ±‚æ•°\|æˆåŠŸç‡" "$log"
done
EOF

chmod +x batch-test.sh
bash batch-test.sh
```

### 4. è‡ªå®šä¹‰è¯·æ±‚é—´éš”

å¦‚æœéœ€è¦æ›´æ”¹è¯·æ±‚é—´éš”ï¼ˆé»˜è®¤3ç§’ï¼‰ï¼Œå¯ä»¥ä¿®æ”¹è„šæœ¬ï¼š

```bash
# ç¼–è¾‘ test-sustained-load.sh
# å°† INTERVAL=3 æ”¹ä¸ºæ‚¨éœ€è¦çš„å€¼

# ä¾‹å¦‚ï¼šæ¯ç§’ä¸€ä¸ªè¯·æ±‚
sed -i 's/INTERVAL=3/INTERVAL=1/' test-sustained-load.sh

# ä¾‹å¦‚ï¼šæ¯5ç§’ä¸€ä¸ªè¯·æ±‚
sed -i 's/INTERVAL=3/INTERVAL=5/' test-sustained-load.sh
```

## ğŸ“ˆ é¢„æœŸç»“æœç¤ºä¾‹

### 60 ç§’æµ‹è¯•
```
=== åœºæ™¯ 5: æŒç»­è´Ÿè½½æµ‹è¯• ===
æµ‹è¯•æ—¶é•¿: 60ç§’ (1.0åˆ†é’Ÿ)
è¯·æ±‚é—´éš”: 3ç§’
é¢„è®¡è¯·æ±‚æ•°: 20
å¼€å§‹æ—¶é—´: Thu Nov  6 12:00:00 CST 2025

...

=== æµ‹è¯•ç»Ÿè®¡ ===
æ€»è¯·æ±‚æ•°: 20
æˆåŠŸ: 20
å¤±è´¥: 0
æˆåŠŸç‡: 100.00%
ç»“æŸæ—¶é—´: Thu Nov  6 12:01:00 CST 2025
```

### 300 ç§’æµ‹è¯•
```
=== åœºæ™¯ 5: æŒç»­è´Ÿè½½æµ‹è¯• ===
æµ‹è¯•æ—¶é•¿: 300ç§’ (5.0åˆ†é’Ÿ)
è¯·æ±‚é—´éš”: 3ç§’
é¢„è®¡è¯·æ±‚æ•°: 100
å¼€å§‹æ—¶é—´: Thu Nov  6 12:00:00 CST 2025

...

=== æµ‹è¯•ç»Ÿè®¡ ===
æ€»è¯·æ±‚æ•°: 100
æˆåŠŸ: 98
å¤±è´¥: 2
æˆåŠŸç‡: 98.00%
ç»“æŸæ—¶é—´: Thu Nov  6 12:05:00 CST 2025
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜: æµ‹è¯•æå‰ç»ˆæ­¢

**åŸå› **: è„šæœ¬å¯èƒ½è¢« Ctrl+C ä¸­æ–­æˆ–ç³»ç»Ÿèµ„æºä¸è¶³

**è§£å†³**:
```bash
# ä½¿ç”¨ nohup åå°è¿è¡Œ
nohup bash test-sustained-load.sh 3600 > logs/test-nohup.log 2>&1 &

# æŸ¥çœ‹è¿›åº¦
tail -f logs/test-nohup.log
```

### é—®é¢˜: éœ€è¦æš‚åœ/æ¢å¤æµ‹è¯•

**è§£å†³**: ä½¿ç”¨ä¿¡å·æ§åˆ¶
```bash
# æŸ¥æ‰¾è¿›ç¨‹ PID
ps aux | grep test-sustained-load

# æš‚åœæµ‹è¯•
kill -STOP <PID>

# æ¢å¤æµ‹è¯•
kill -CONT <PID>

# ä¼˜é›…ç»ˆæ­¢
kill -TERM <PID>
```

### é—®é¢˜: æƒ³è¦æ›´è¯¦ç»†çš„æ—¥å¿—

**è§£å†³**: å¯ç”¨è°ƒè¯•æ¨¡å¼
```bash
# ä¿®æ”¹è„šæœ¬å¼€å¤´æ·»åŠ 
set -x  # å¯ç”¨è°ƒè¯•è¾“å‡º

# æˆ–è€…è¿è¡Œæ—¶å¯ç”¨
bash -x test-sustained-load.sh 300
```

## ğŸ“ æµ‹è¯•å‰æ£€æŸ¥æ¸…å•

- [ ] åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ (`curl http://localhost:8080/health`)
- [ ] Redis å¯è®¿é—® (`docker exec redis-dev redis-cli ping`)
- [ ] è´¦æˆ·å·²æ­£ç¡®æ·»åŠ åˆ° Redis
- [ ] API Key å·²åˆ›å»ºå¹¶ç»‘å®šè´¦æˆ·
- [ ] æµ‹è¯•è´¦æˆ·çš„ session_token æœ‰æ•ˆ
- [ ] ç¡®è®¤æµ‹è¯•æ—¶é•¿ï¼ˆé¿å…æ„å¤–çš„é•¿æ—¶é—´æµ‹è¯•ï¼‰
- [ ] å‡†å¤‡è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´å­˜å‚¨æ—¥å¿—

## ğŸ‰ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å‡†å¤‡ç¯å¢ƒ
cd /mnt/d/prj/claude-relay-service
make rust-dev

# å¿«é€Ÿæµ‹è¯• (1åˆ†é’Ÿ)
bash test-sustained-load.sh 60

# æ ‡å‡†æµ‹è¯• (5åˆ†é’Ÿ)
bash test-sustained-load.sh 300

# éªŒè¯ç»Ÿè®¡
bash verify-stats.sh

# æŸ¥çœ‹ç›‘æ§
bash monitor-stats.sh

# åˆ†ææ—¥å¿—
bash analyze-logs.sh

# å®Œæ•´æµ‹è¯•å¥—ä»¶
bash run-full-test.sh
```

---

**æç¤º**: æµ‹è¯•æ—¶é•¿å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚çµæ´»è°ƒæ•´ã€‚å»ºè®®ä»è¾ƒçŸ­çš„æ—¶é•¿å¼€å§‹ï¼ˆå¦‚60ç§’ï¼‰ï¼Œç¡®è®¤ä¸€åˆ‡æ­£å¸¸åå†è¿›è¡Œé•¿æ—¶é—´æµ‹è¯•ã€‚
